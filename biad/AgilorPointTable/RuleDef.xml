<?xml version="1.0" encoding="UTF-8"?>
<dataroot xmlns:od="urn:schemas-microsoft-com:officedata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  xsi:noNamespaceSchemaLocation="RuleDef.xsd" generated="2017-11-27T15:16:01">
<RuleDef>
<Name>FCU_F8_8_1Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_1Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_1&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_1CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_1_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_1_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_1_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_1_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_1&quot;;
string autoRuleName = &quot;FCU_F8_8_1Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_2Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_2Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_2&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_2CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_2_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_2_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_2_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_2_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_2&quot;;
string autoRuleName = &quot;FCU_F8_8_2Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_3Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_3Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_3&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_3CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_3_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_3_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_3_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_3_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_3&quot;;
string autoRuleName = &quot;FCU_F8_8_3Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_4Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_4Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_4&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_4CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_4_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_4_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_4_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_4_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_4&quot;;
string autoRuleName = &quot;FCU_F8_8_4Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_5Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_5Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_5&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_5CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_5_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_5_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_5_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_5_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_5&quot;;
string autoRuleName = &quot;FCU_F8_8_5Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_6Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_6Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_6&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_6CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_6_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_6_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_6_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_6_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_6&quot;;
string autoRuleName = &quot;FCU_F8_8_6Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_7Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_7Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_7&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_7CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_7_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_7_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_7_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_7_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_7&quot;;
string autoRuleName = &quot;FCU_F8_8_7Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_8Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_8Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_8&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_8CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_8_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_8_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_8_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_8_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_8&quot;;
string autoRuleName = &quot;FCU_F8_8_8Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_9Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_9Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_9&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_9CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_9_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_9_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_9_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_9_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_9&quot;;
string autoRuleName = &quot;FCU_F8_8_9Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_10Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_10Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_10&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_10CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_10_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_10_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_10_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_10_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_10&quot;;
string autoRuleName = &quot;FCU_F8_8_10Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_11Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_11Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_11&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_11CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_11_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_11_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_11_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_11_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_11&quot;;
string autoRuleName = &quot;FCU_F8_8_11Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_12Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_12Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_12&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_12CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_12_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_12_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_12_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_12_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_12&quot;;
string autoRuleName = &quot;FCU_F8_8_12Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_13Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_13Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_13&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_13CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_13_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_13_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_13_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_13_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_13&quot;;
string autoRuleName = &quot;FCU_F8_8_13Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_14Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_14Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_14&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_14CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_14_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_14_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_14_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_14_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_14&quot;;
string autoRuleName = &quot;FCU_F8_8_14Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_15Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_15Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_15&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_15CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_15_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_15_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_15_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_15_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_15&quot;;
string autoRuleName = &quot;FCU_F8_8_15Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_16Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_16Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_16&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_16CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_16_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_16_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_16_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_16_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_16&quot;;
string autoRuleName = &quot;FCU_F8_8_16Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_17Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_17Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_17&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_17CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_17_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_17_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_17_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_17_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_17&quot;;
string autoRuleName = &quot;FCU_F8_8_17Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_18Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_18Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_18&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_18CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_18_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_18_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_18_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_18_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_18&quot;;
string autoRuleName = &quot;FCU_F8_8_18Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_19Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_19Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_19&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_19CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_19_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_19_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_19_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_19_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_19&quot;;
string autoRuleName = &quot;FCU_F8_8_19Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_20Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_20Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_20&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_20CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_20_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_20_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_20_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_20_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_20&quot;;
string autoRuleName = &quot;FCU_F8_8_20Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_21Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_21Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_21&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_21CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_21_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_21_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_21_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_21_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_21&quot;;
string autoRuleName = &quot;FCU_F8_8_21Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_22Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_22Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_22&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_22CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_22_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_22_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_22_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_22_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_22&quot;;
string autoRuleName = &quot;FCU_F8_8_22Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_23Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_23Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_23&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_23CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_23_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_23_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_23_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_23_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_23&quot;;
string autoRuleName = &quot;FCU_F8_8_23Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_24Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_24Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_24&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_24CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_24_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_24_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_24_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_24_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_24&quot;;
string autoRuleName = &quot;FCU_F8_8_24Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_25Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_25Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_25&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_25CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_25_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_25_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_25_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_25_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_25&quot;;
string autoRuleName = &quot;FCU_F8_8_25Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_26Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_26Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_26&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_26CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_26_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_26_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_26_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_26_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_26&quot;;
string autoRuleName = &quot;FCU_F8_8_26Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_27Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_27Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_27&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_27CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_27_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_27_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_27_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_27_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_27&quot;;
string autoRuleName = &quot;FCU_F8_8_27Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_28Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_28Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_28&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_28CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_28_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_28_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_28_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_28_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_28&quot;;
string autoRuleName = &quot;FCU_F8_8_28Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_29Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_29Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_29&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_29CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_29_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_29_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_29_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_29_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_29&quot;;
string autoRuleName = &quot;FCU_F8_8_29Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_30Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_30Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_30&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_30CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_30_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_30_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_30_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_30_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_30&quot;;
string autoRuleName = &quot;FCU_F8_8_30Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_31Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_31Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_31&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_31CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_31_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_31_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_31_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_31_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_31&quot;;
string autoRuleName = &quot;FCU_F8_8_31Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_32Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_32Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_32&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_32CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_32_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_32_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_32_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_32_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_32&quot;;
string autoRuleName = &quot;FCU_F8_8_32Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_33Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_33Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_33&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_33CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_33_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_33_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_33_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_33_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_33&quot;;
string autoRuleName = &quot;FCU_F8_8_33Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_34Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_34Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_34&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_34CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_34_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_34_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_34_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_34_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_34&quot;;
string autoRuleName = &quot;FCU_F8_8_34Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_35Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_35Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_35&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_35CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_35_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_35_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_35_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_35_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_35&quot;;
string autoRuleName = &quot;FCU_F8_8_35Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_36Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_36Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_36&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_36CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_36_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_36_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_36_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_36_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_36&quot;;
string autoRuleName = &quot;FCU_F8_8_36Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_37Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_37Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_37&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_37CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_37_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_37_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_37_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_37_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_37&quot;;
string autoRuleName = &quot;FCU_F8_8_37Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_38Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_38Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_38&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_38CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_38_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_38_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_38_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_38_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_38&quot;;
string autoRuleName = &quot;FCU_F8_8_38Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_39Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_39Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_39&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_39CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_39_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_39_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_39_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_39_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_39&quot;;
string autoRuleName = &quot;FCU_F8_8_39Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_40Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_40Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_40&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_40CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_40_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_40_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_40_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_40_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_40&quot;;
string autoRuleName = &quot;FCU_F8_8_40Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_41Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_41Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_41&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_41CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_41_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_41_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_41_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_41_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_41&quot;;
string autoRuleName = &quot;FCU_F8_8_41Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_42Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F8_8_42Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_42&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F8_8_42CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F8_8_42_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F8_8_42_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F8_8_42_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F8_8_42_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F8_8_42&quot;;
string autoRuleName = &quot;FCU_F8_8_42Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_1Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_1Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_1&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_1CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_1_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_1_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_1_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_1_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_1&quot;;
string autoRuleName = &quot;FCU_F7_7_1Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_2Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_2Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_2&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_2CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_2_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_2_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_2_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_2_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_2&quot;;
string autoRuleName = &quot;FCU_F7_7_2Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_3Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_3Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_3&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_3CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_3_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_3_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_3_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_3_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_3&quot;;
string autoRuleName = &quot;FCU_F7_7_3Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_4Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_4Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_4&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_4CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_4_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_4_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_4_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_4_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_4&quot;;
string autoRuleName = &quot;FCU_F7_7_4Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_5Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_5Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_5&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_5CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_5_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_5_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_5_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_5_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_5&quot;;
string autoRuleName = &quot;FCU_F7_7_5Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_6Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_6Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_6&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_6CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_6_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_6_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_6_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_6_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_6&quot;;
string autoRuleName = &quot;FCU_F7_7_6Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_7Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_7Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_7&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_7CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_7_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_7_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_7_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_7_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_7&quot;;
string autoRuleName = &quot;FCU_F7_7_7Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_8Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_8Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_8&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_8CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_8_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_8_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_8_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_8_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_8&quot;;
string autoRuleName = &quot;FCU_F7_7_8Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_9Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_9Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_9&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_9CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_9_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_9_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_9_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_9_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_9&quot;;
string autoRuleName = &quot;FCU_F7_7_9Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_10Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_10Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_10&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_10CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_10_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_10_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_10_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_10_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_10&quot;;
string autoRuleName = &quot;FCU_F7_7_10Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_11Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_11Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_11&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_11CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_11_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_11_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_11_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_11_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_11&quot;;
string autoRuleName = &quot;FCU_F7_7_11Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_12Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_12Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_12&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_12CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_12_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_12_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_12_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_12_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_12&quot;;
string autoRuleName = &quot;FCU_F7_7_12Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_13Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_13Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_13&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_13CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_13_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_13_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_13_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_13_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_13&quot;;
string autoRuleName = &quot;FCU_F7_7_13Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_14Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_14Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_14&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_14CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_14_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_14_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_14_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_14_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_14&quot;;
string autoRuleName = &quot;FCU_F7_7_14Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_15Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_15Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_15&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_15CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_15_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_15_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_15_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_15_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_15&quot;;
string autoRuleName = &quot;FCU_F7_7_15Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_16Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_16Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_16&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_16CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_16_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_16_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_16_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_16_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_16&quot;;
string autoRuleName = &quot;FCU_F7_7_16Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_17Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_17Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_17&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_17CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_17_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_17_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_17_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_17_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_17&quot;;
string autoRuleName = &quot;FCU_F7_7_17Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_18Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_18Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_18&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_18CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_18_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_18_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_18_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_18_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_18&quot;;
string autoRuleName = &quot;FCU_F7_7_18Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_19Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_19Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_19&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_19CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_19_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_19_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_19_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_19_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_19&quot;;
string autoRuleName = &quot;FCU_F7_7_19Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_20Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_20Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_20&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_20CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_20_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_20_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_20_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_20_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_20&quot;;
string autoRuleName = &quot;FCU_F7_7_20Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_21Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_21Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_21&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_21CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_21_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_21_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_21_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_21_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_21&quot;;
string autoRuleName = &quot;FCU_F7_7_21Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_22Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_22Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_22&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_22CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_22_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_22_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_22_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_22_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_22&quot;;
string autoRuleName = &quot;FCU_F7_7_22Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_23Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_23Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_23&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_23CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_23_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_23_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_23_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_23_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_23&quot;;
string autoRuleName = &quot;FCU_F7_7_23Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_24Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_24Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_24&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_24CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_24_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_24_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_24_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_24_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_24&quot;;
string autoRuleName = &quot;FCU_F7_7_24Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_25Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_25Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_25&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_25CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_25_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_25_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_25_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_25_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_25&quot;;
string autoRuleName = &quot;FCU_F7_7_25Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_26Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_26Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_26&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_26CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_26_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_26_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_26_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_26_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_26&quot;;
string autoRuleName = &quot;FCU_F7_7_26Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_27Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_27Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_27&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_27CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_27_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_27_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_27_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_27_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_27&quot;;
string autoRuleName = &quot;FCU_F7_7_27Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_28Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_28Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_28&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_28CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_28_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_28_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_28_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_28_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_28&quot;;
string autoRuleName = &quot;FCU_F7_7_28Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_29Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_29Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_29&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_29CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_29_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_29_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_29_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_29_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_29&quot;;
string autoRuleName = &quot;FCU_F7_7_29Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_30Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_30Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_30&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_30CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_30_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_30_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_30_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_30_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_30&quot;;
string autoRuleName = &quot;FCU_F7_7_30Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_31Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_31Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_31&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_31CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_31_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_31_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_31_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_31_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_31&quot;;
string autoRuleName = &quot;FCU_F7_7_31Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_32Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_32Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_32&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_32CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_32_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_32_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_32_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_32_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_32&quot;;
string autoRuleName = &quot;FCU_F7_7_32Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_33Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_33Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_33&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_33CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_33_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_33_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_33_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_33_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_33&quot;;
string autoRuleName = &quot;FCU_F7_7_33Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_34Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_34Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_34&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_34CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_34_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_34_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_34_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_34_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_34&quot;;
string autoRuleName = &quot;FCU_F7_7_34Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_35Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_35Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_35&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_35CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_35_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_35_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_35_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_35_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_35&quot;;
string autoRuleName = &quot;FCU_F7_7_35Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_36Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_36Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_36&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_36CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_36_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_36_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_36_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_36_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_36&quot;;
string autoRuleName = &quot;FCU_F7_7_36Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_37Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_37Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_37&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_37CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_37_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_37_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_37_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_37_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_37&quot;;
string autoRuleName = &quot;FCU_F7_7_37Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_38Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_38Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_38&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_38CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_38_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_38_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_38_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_38_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_38&quot;;
string autoRuleName = &quot;FCU_F7_7_38Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_39Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_39Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_39&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_39CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_39_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_39_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_39_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_39_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_39&quot;;
string autoRuleName = &quot;FCU_F7_7_39Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_40Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_40Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_40&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_40CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_40_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_40_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_40_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_40_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_40&quot;;
string autoRuleName = &quot;FCU_F7_7_40Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_41Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_41Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_41&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_41CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_41_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_41_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_41_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_41_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_41&quot;;
string autoRuleName = &quot;FCU_F7_7_41Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_42Auto</Name>
<Event>OnTimer(&quot;Timer.FCU_F7_7_42Auto_Tmr0&quot;,3)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_42&quot;;
string tagTempName, tagTempSetName;
string tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
string tagCoolValveCtrl;
tagTempName = tagBaseName + &quot;_Temp&quot;;
tagTempSetName = tagBaseName + &quot;_TempSet&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;
tagCoolValveCtrl = tagBaseName + &quot;_ElecAirCleanerCtrl1&quot;;

float tempDiff = 0;
tempDiff = ToFloat(TagVal(tagTempSetName)) - TagVal(tagTempName);
float coolValve = 0;
if(tempDiff &lt; 0){
    coolValve = 0;
    tempDiff = -1 * tempDiff;
} else {
    coolValve = 1;
}
string fanSpeed = &quot;FanSpeedClose&quot;;
if(tempDiff &gt; 2 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedHigh&quot;;
} else if(tempDiff &gt; 1 * FAN_AUTO_TEMP_DIFF){
    fanSpeed = &quot;FanSpeedMid&quot;;
} else if(tempDiff &gt; 0) {
    fanSpeed = &quot;FanSpeedLow&quot;;
}

if(fanSpeed == &quot;FanSpeedHigh&quot; and TagVal(tagFanSpeedHighName) != 1){
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedHighName, 1, true);
} else if(fanSpeed == &quot;FanSpeedMid&quot; and TagVal(tagFanSpeedMidName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    SetTagVal(tagFanSpeedMidName, 1, true);
} else if(fanSpeed == &quot;FanSpeedLow&quot; and TagVal(tagFanSpeedLowName) != 1){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    SetTagVal(tagFanSpeedLowName, 1, true);
} else if(fanSpeed == &quot;FanSpeedClose&quot;){
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
}

if(TagVal(tagCoolValveCtrl) != coolValve){
    SetTagVal(tagCoolValveCtrl, coolValve, true);
}
printf(&quot;Finish Auto Rule:&quot; + tagBaseName);</Action>
<Description></Description>
<Valid>0</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
<RuleDef>
<Name>FCU_F7_7_42CE</Name>
<Event>OnChange(&quot;Agilor.FCU_F7_7_42_FanSpeed__Low&quot;) or OnChange(&quot;Agilor.FCU_F7_7_42_FanSpeed&quot;) or OnChange(&quot;Agilor.FCU_F7_7_42_FanSpeed__Mid&quot;) or OnChange(&quot;Agilor.FCU_F7_7_42_FanSpeed__High&quot;)</Event>
<Condition>true</Condition>
<Action>string tagBaseName = &quot;Agilor.FCU_F7_7_42&quot;;
string autoRuleName = &quot;FCU_F7_7_42Auto&quot;;
string tagFanSpeedName, tagFanSpeedHighName, tagFanSpeedMidName, tagFanSpeedLowName;
tagFanSpeedName = tagBaseName + &quot;_FanSpeed&quot;;
tagFanSpeedHighName = tagBaseName + &quot;_FanSpeed__High&quot;;
tagFanSpeedMidName = tagBaseName + &quot;_FanSpeed__Mid&quot;;
tagFanSpeedLowName = tagBaseName + &quot;_FanSpeed__Low&quot;;

string eventSourceName;
eventSourceName = EventSourceName();
if(eventSourceName == tagFanSpeedHighName and TagVal(tagFanSpeedHighName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedHigh&quot;, false);
} else if(eventSourceName == tagFanSpeedLowName and TagVal(tagFanSpeedLowName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedLow&quot;, false);
} else if(eventSourceName == tagFanSpeedMidName and TagVal(tagFanSpeedMidName) == 1 and TagVal(tagFanSpeedName) != &quot;FanSpeedAuto&quot;){
    SetTagVal(tagFanSpeedName, &quot;FanSpeedMid&quot;, false);
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedHigh&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedHighName) != 1){
        SetTagVal(tagFanSpeedHighName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedMid&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) != 1){
        SetTagVal(tagFanSpeedMidName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedLow&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) != 1){
        SetTagVal(tagFanSpeedLowName, 1, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedClose&quot;){
    DisableRule(autoRuleName);
    if(TagVal(tagFanSpeedHighName) == 1){
        SetTagVal(tagFanSpeedHighName, 0, true);
    }
    if(TagVal(tagFanSpeedMidName) == 1){
        SetTagVal(tagFanSpeedMidName, 0, true);
    }
    if(TagVal(tagFanSpeedLowName) == 1){
        SetTagVal(tagFanSpeedLowName, 0, true);
    }
} else if(eventSourceName == tagFanSpeedName and TagVal(tagFanSpeedName) == &quot;FanSpeedAuto&quot;){
    EnableRule(autoRuleName);
} else if(eventSourceName == tagFanSpeedName){
    printf(&quot;Error: &quot; + tagBaseName + &quot; FanSpeed Value(&quot; + TagVal(tagFanSpeedName) + &quot;) Error!&quot;);
    SetTagVal(tagFanSpeedName, &quot;FanSpeedClose&quot;, false);
}</Action>
<Description></Description>
<Valid>1</Valid>
<AutoLoad>1</AutoLoad>
</RuleDef>
</dataroot>
